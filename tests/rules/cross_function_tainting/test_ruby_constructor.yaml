rules:
  - id: ruby_constructor_sqli
    message: SQL injection through constructor
    languages:
      - ruby
    severity: ERROR
    mode: taint
    pattern-sources:
      - pattern: taint
    pattern-sinks:
      - patterns:
          - pattern: |
              "$SQLSTR#{$EXPR}..."
          - metavariable-regex:
              metavariable: $SQLSTR
              regex: ^\s*((SELECT|select|DELETE|delete|INSERT|insert|UPDATE|update|CALL|call)|(?i)(REPLACE INTO))\s(\s|.)*
          - focus-metavariable: $EXPR
    
